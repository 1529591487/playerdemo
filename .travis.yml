language: cpp

os:
  - linux
  
dist:
  # Request Ubuntu 16 as linux
  - xenial
compiler: 
  - gcc
  
# safelist
branches:
  except:
    - gh-pages
    
before_install:
  # Setup the repository. Qt 5.10 on linux.
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo add-apt-repository ppa:beineri/opt-qt59-xenial -y; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get update -qq; fi
  # On linux also get a newer g++. The old one won't work.
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get update -qq; fi
  
install:
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install -qq qt59base; source /opt/qt59/bin/qt59-env.sh; fi
  # On linux, install the new g++ version
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install -qq g++-7; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-7 90; fi
  # SDL2
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install libsdl2-2.0-0 libsdl2-dev; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install ffmpeg; fi
  
script:
  # Run qmake and make
  - cd playerdemo
  - qmake
  - make

before_deploy:
  # Here we could package something, create zips and so on.

deploy:
  # We need the compiled files
  # skip_cleanup: true
  # Here we can deploy. Or it could be done in the before_deploy or after_success steps.